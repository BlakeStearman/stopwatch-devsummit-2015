<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>Stopwatch</title>

  <link rel="stylesheet" href="./css/app.css">
</head>
<body>
  <div class="nav">
    <a href="./index.html">< Back</a> | Stopwatch script
  </div>

  <div class="display">
    <div id="timer">00:00:00:000</div>
    <button type="button" id="start-button">Start</button>
    <button type="button" id="stop-button">Stop</button>
  </div>

  <script>
    var displayInterval,
        displayNode = document.getElementById("timer"),
        startTime = 0,
        stopTime = 0,
        running = false;

    // functions
    function isRunning() {
      return running;
    }

    function reset() {
      startTime = 0;
      stopTime = 0;
    }

    function start() {
      if(!isRunning()) {
        running = true;

        if(startTime === 0) {
          startTime = Date.now();
        }

      }
    }

    function stop() {
      if(isRunning()) {
        running = false;
        stopTime = Date.now();
      }
    }

    function time() {
      var finalTime = isRunning() ? Date.now() : stopTime;
      return finalTime - startTime;
    }

    function displayTime() {
      var totalTime = time() || 0,
          milliseconds = parseInt(totalTime % 1000),
          seconds = parseInt(((totalTime - milliseconds) / 1000) % 60),
          minutes = parseInt(((((totalTime - milliseconds) / 1000) - seconds) / 60) % 60),
          hours = parseInt(((((((totalTime - milliseconds) / 1000) - seconds) / 60) - minutes) / 60) % 24);
      return padWithZeros(hours, 2) + ":" +
             padWithZeros(minutes, 2) + ":" +
             padWithZeros(seconds, 2) + ":" +
             padWithZeros(milliseconds, 3);
    }

    function padWithZeros(number, upTo) {
      var numberText = number.toString(),
          totalChars = numberText.length,
          zerosNeeded;

      if(totalChars >= upTo) {
        return numberText;
      }

      zerosNeeded = upTo - totalChars;

      for(var i = 0; i < zerosNeeded; i++) {
        numberText = "0" + numberText;
      }

      return numberText;
    }

    // connect buttons
    document.getElementById("start-button").addEventListener("click", function() {
      start();
      if(!displayInterval) {
        displayInterval = setInterval(function() {
          displayNode.innerHTML = displayTime();
        }, 25);
      }
    });
    document.getElementById("stop-button").addEventListener("click", function() {
      if(isRunning()) {
        stop();
      } else {
        reset();
        clearInterval(displayInterval);
        displayInterval = null;
        displayNode.innerHTML = displayTime();
      }
    });
  </script>
</body>
</html>